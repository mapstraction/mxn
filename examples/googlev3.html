<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Mapstraction Examples - Google v3</title>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script src="../source/mxn.js?(googlev3,[geocoder])" type="text/javascript"></script>
<script src="../source/mxn.geocoder.js" type="text/javascript"></script>
<style type="text/css">
#mapdiv {
  height: 400px;
}
</style> 

<script type="text/javascript">
//<![CDATA[

var mapstraction;
var geocoder;

  function geocode_return(geocoded_location) {
	  
      // display the map centered on a latitude and longitude (Google zoom levels)
      mapstraction.setCenterAndZoom(geocoded_location.point, 15);
  
      // create a marker positioned at a lat/lon
      var geocode_marker = new mxn.Marker(geocoded_location.point);
  
      var address = geocoded_location.locality + ", " + geocoded_location.region;
      geocode_marker.setInfoBubble(address);
      
      // display marker
      mapstraction.addMarker(geocode_marker);
  
      // open the marker
      geocode_marker.openBubble();
  }

  function initialize() {

		// create mxn object
		mapstraction = new mxn.Mapstraction('mapdiv','googlev3');

		mapstraction.addControls({
			pan: true,
			zoom: 'small',
			map_type: true
		});

		var latlon = new mxn.LatLonPoint(51.53468413093941, -0.09026169776916504);

		mapstraction.setCenterAndZoom(latlon, 16);
		
		geocoder = new mxn.Geocoder('googlev3',geocode_return);
		
		//console.log(geocoder);

		// add a marker
		var marker = new mxn.Marker(latlon);
		marker.setDraggable(true);
		marker.dragend.addHandler(function(n, s, a) {
			console.log(n);
			console.log(s);
		});
		mapstraction.addMarker(marker,true);
		
  }

  function user_submit() {
      var address = new Object();
      address.address = document.getElementById('address').value;
      geocoder.geocode(address);
  }
  
  function changetohybrid(){
    mapstraction.setMapType(mxn.Mapstraction.HYBRID);  
  }
  
//]]>
</script> 

</head>
<body onload="initialize();">
<center>
<table border='1' width='50%'>
<tr>
	<td><div id="mapdiv"></div></td>
</tr>
<tr>
	<td>
		<input type="text" id="address" name="address" value="" size="35"/>
		<a href="#" onclick="user_submit(); return false;">Geocode</a>
	</td>
</tr>
</table>
<a href='#' onclick='changetohybrid();'>change to hybrid</a>
</center>
</body> 
</html>

